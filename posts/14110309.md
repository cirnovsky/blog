---
date: '2020-12-09'
title: 'Craft 1'
---

### NOIP2020 B 字符串匹配

正解有点意思。

先说 $\Theta(26Tn+Tn\ln n)$ 的做法。

其实也没什么可说的，不说了。

我这里有一个理论 $\Theta(n\ln n+Tn)$ 的做法，只不过后面想不动了，有兴趣的人可以思考一下。

首先我们 $\Theta(n\ln n)$ 筛出 $d(n)$ 表示 $n$ 的约数个数，这个直接预处理，用不着放到 $T$ 里面。

然后进入到 $T$ 个循环里，得到字符串及其长度 $n$。

此时我们预处理出 $\text{buc}_{i}$ 表示 $F(S_{1,i})$，这个可以用一个辅助数组简单 $\Theta(n)$ 完成。

然后我们枚举 $C$，只不过如果要保证复杂度需要从 $3$ 到 $n$ 枚举，设当前枚举的 $C$ 为 $S_{i,n}$，那么 $(AB)^{x}=S_{1,i-1}$。

这里我有一个不用 KMP 也不用 Hash 的求基循环节的方法，复杂度枚举完 $C$ 均摊下来也是线性。

具体是这样做的，首先我们设当前的 $(AB)^{x}$ 在 $S$ 中为 $S_{1,j}$。

然后设几个变量。

- $\text{cur}$ 表示下一步需要匹配的字符要在我们当前求出的基循环节中匹配哪一位。

- $\text{len}$ 表示当前的循环节长度

完了这个东西被 hack 了。

不写了。

算了心态崩了有空再补正解。

### 