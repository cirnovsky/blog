<!DOCTYPE html>
    <html lang="zh-cmn-Hans">
        <head>
            <meta charset="UTF-8" />
            <title>Solution -ã€ŒCF 1827Cã€Palindrome Partition | cirnovsky</title>

            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.css" integrity="sha384-5TcZemv2l/9On385z///+d7MSYlvIEw9FuZTIdZ14vJLqWphw7e7ZPuOiCHJcFCP" crossorigin="anonymous">

            <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/katex.min.js" integrity="sha384-cMkvdD8LoxVzGF/RPUKAcvmm49FQ0oxwDF3BGKtDXcEc+T1b2N+teh/OJfpU0jr6" crossorigin="anonymous"></script>

            <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.22/dist/contrib/auto-render.min.js" integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh" crossorigin="anonymous"
                onload="renderMathInElement(document.body);"></script>
            <script src="/src/js/jquery.min.js"></script>
            <link rel="stylesheet" href="/src/styles/prism.css" >
            <link rel="stylesheet" href="/src/styles/fonts.css" >
            <link rel="stylesheet" href="/src/styles/style.css" >
            <script>
                document.addEventListener("DOMContentLoaded", function() {
                    $("#giscus").load("/src/html/giscus.html")
                    $("#header").load("/src/html/header.html")
                    renderMathInElement(document.body, {
                        delimiters: [
                            {left: "$$", right: "$$", display: true},
                            {left: "$", right: "$", display: false}
                        ],
                        throwOnError: false,
                        errorColor: "#cc0000"
                    });
                })
            </script>
        </head>
        <body>
            <script src="/src/js/prism.js"></script>
            <div class="content">
                <div id="header"></div>
                <h2>Desc.</h2>  
<p><a href="https://codeforces.com/problemset/problem/1827/C">Link.</a></p>  
<p>å®šä¹‰<strong>å¥½ä¸²</strong>ä¸ºä¸€ä¸ªæˆ–å¤šä¸ªå¶å›æ–‡ä¸²æ‹¼æ¥çš„ç»“æœ. ç»™å‡ºä¸€ä¸ªå­—ç¬¦ä¸², æ±‚å…¶ä¸º<strong>å¥½ä¸²</strong>çš„å­ä¸²æ•°.</p>  
<h2>Sol.</h2>  
<p>è€ƒè¯•çš„æ—¶å€™çŠ¯ç—…äº†, æ±‚ $f_i$ å±…ç„¶æ²¡æœ‰æƒ³åˆ°ä»»ä½•å­—ç¬¦ä¸²ç®—æ³•, è€Œå»è¿è¾¹å†™æˆäº†å›¾è®ºé¢˜... æœ‰ç‚¹ç¦»è°±. ğŸ¤”</p>  
<p>å®¹æ˜“æƒ³åˆ°ä¸€ä¸ª DP, è®¾ $f_i$ è¡¨ç¤ºåœ¨ $i$ ç»“å°¾çš„æçŸ­å¶å›æ–‡ä¸²çš„é•¿åº¦, $g_i$ è¡¨ç¤ºåœ¨ $i$ ç»“å°¾çš„å¥½ä¸²æ•°é‡, æœ‰ $g$ çš„è½¬ç§»:  
$$
g_i = g_{i-f_i}+1  
$$
è‹¥ $f_i$ ä¸å­˜åœ¨åˆ™ä¸º $0$. æ¥ä¸‹æ¥è€ƒè™‘æ€ä¹ˆæ±‚ $f_i$.</p>  
<p>æˆ‘ä»¬å…ˆæ±‚å‡º $rad_i$ è¡¨ç¤ºä»¥<strong>é—´éš”</strong> $i$ ä¸ºä¸­å¿ƒçš„å›æ–‡ä¸²é•¿åº¦, è¿™ä¸ªå¯ä»¥ç”¨å„ç§å§¿åŠ¿æ±‚, æ¯”å¦‚äºŒåˆ† &amp; å“ˆå¸Œ, PAM, Manacher etc. ç„¶åå‘ç° $f_i$ å¯ä»¥ç”¨ä¸€ä¸ª $rad_j$ æ¥æ›´æ–°, å…¶ä¸­ $j &lt; i, j+rad_j \geqslant i$. æˆ‘ä»¬è‚¯å®šå¸Œæœ› $i$ å’Œ $j$ é å¾—è¶Šè¿‘è¶Šå¥½. äºæ˜¯å€’ç€æ‰«æ, ç”¨å¹¶æŸ¥é›†ç»´æŠ¤è¿ç»­æ®µ, ä»¥ $rad_i$ æ›´æ–°è¿ç»­æ®µ. è¿™ä¸ªæœ‰ç‚¹æ²¡è¯´æ¸…æ¥š, å…·ä½“å¯ä»¥çœ‹ä»£ç , ä»£ç åº”è¯¥ä¼šæ›´å¥½ç†è§£.</p>  


<pre><code class="language-cpp">void solve() {
    int n; string tmp, s; cin &gt;&gt; n &gt;&gt; tmp;
    for (int i=0;i&lt;n;++i) s.pb(tmp[i]), s.pb('|');
    s.pop_back();
    const int m = 2*n-1;
    const ull BASE = 1331;
    vector&lt;ull&gt; pw(m);
    vector hs(2, vector&lt;ull&gt;(m+1));
    pw[0] = 1;
    for (int i=1;i&lt;m;++i) pw[i] = pw[i-1]*BASE;
    for (int i=0;i&lt;m;++i) hs[0][i+1] = hs[0][i]*BASE+s[i]-'a'+1;
    for (int i=m-1;i&gt;=0;--i) hs[1][i] = hs[1][i+1]*BASE+s[i]-'a'+1;
    const auto getHash = [&amp;](int l, int r, int idx) {
        if (idx == 0) return hs[0][r]-hs[0][l]*pw[r-l];
        return hs[1][l]-hs[1][r]*pw[r-l];
    };
    vi rad(m);
    for (int i=0;i&lt;m;++i) {
        int l = 0, r = min(i, m-i-1), res = 0;
        while (l &lt;= r) {
            int mid = (l+r)/2;
            if (getHash(i-mid, i, 0) == getHash(i+1, i+mid+1, 1)) l = mid+1, res = mid;
            else r = mid-1;
        }
        rad[i] = res;
    }
    vi fa(m);
    iota(allu(fa), 0);
    const auto find = [&amp;](int u) {
        while (u != fa[u]) u = fa[u] = fa[fa[u]];
        return u;
    };
    vi f(n);
    for (int i=m-2;i&gt;=0;i-=2) {
        for (int j;(j=find(i+rad[i]))&gt;=i;) {
            if (j%2 == 0) f[j/2] = (j-i+1)/2;
            fa[j] = j-1;
        }
    }
    vll g(n);
    for (int i=0;i&lt;n;++i)
        if (f[i]) {
            if (i/2 &gt;= f[i]) g[i] = g[i-2*f[i]]+1;
            else g[i] = 1;
        }
    cout &lt;&lt; accumulate(allu(g), 0ll) &lt;&lt; &quot;\n&quot;;
}
</code></pre>
<hr />  

<div class="panel panel-success">
    <div class="panel-heading">ä¸€è¨€</div>
    <div class="panel-body">
  
<p>/ å…‰ä¸å½±ã€€æ˜¯å¦ä¸è¯¥åœ¨è¿™ä¸€åˆ»ç›¸é€¢ /</p>  
<p>/ è€Œä½ å’Œæˆ‘ä»æ¥è°ä¹Ÿä¸æ˜¯è°çš„é™„åº¸ /</p>  
<p>/ æˆ‘æ”¾é€è‡ªå·±æ®‹ç¼ºçš„é­‚é­„ /</p>  
<p>/ åœ¨é•œå­èƒŒé¢é‚£ä¸€å›½ /</p>  
<p>/ ä¸€è·¯ä¸Šä»æ²¡æœ‰æŒ½ç•™è¿‡ /</p>  
<p>/ é‚£äº›å¾’åŠ³å¥”æ³¢ã€€å´ä¸æ›¾å®Œæ•´çš„æˆ‘ /</p>  
<p>â€”â€” <a href="https://vocadb.net/S/291185/">Kide - <em>é›¶å’Œ Zero-Sum</em> ft. Minus</a></p>  

    </div>
</div>
                <script src="https://giscus.app/client.js" data-repo="cirnovsky/blog-comments" data-repo-id="R_kgDOKmz0Wg" data-category="General" data-category-id="DIC_kwDOKmz0Ws4Caiud" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="gruvbox" data-lang="en" crossorigin="anonymous" async></script>
            </div>
        </body>
    </html>
